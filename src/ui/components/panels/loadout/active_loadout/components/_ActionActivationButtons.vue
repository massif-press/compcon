<template>
  <v-col cols="auto">
    <v-btn
      large
      tile
      block
      class="text-white"
      :disabled="disableCostActivate"
      :color="`${action.Color}`"
      @click="select()"
    >
      <v-icon start>{{ action.Icon }}</v-icon>
      {{ action.Name }}
    </v-btn>
    <v-btn
      v-if="!fulltech && action.Activation !== 'Free' && action.Activation !== 'Protocol'"
      small
      tile
      block
      class="text-white"
      color="action--free"
      @click="select(true)"
    >
      <v-icon start small>cc:free_action</v-icon>
      Free Action
      <cc-tooltip
        inline
        :content="`Special rules or equipment may allow you to ${action.Name} as a Free Action. Using this button will commit the action without spending a ${action.Activation} Action this turn`"
      >
        <v-icon end small variant="plain">mdi-information-outline</v-icon>
      </cc-tooltip>
    </v-btn>
    <div v-if="action.HeatCost" class="text-overline text-error text-center">
      ALERT: This action will incur {{ action.HeatCost }} heat
    </div>
  </v-col>
</template>

<script lang="ts">
import { ActivationType } from '@/class';

export default {
  name: 'action-activation-buttons',
  props: {
    used: { type: Boolean },
    fulltech: { type: Boolean, default: false },
    action: {
      type: Object,
      required: true,
    },
    mech: {
      type: Object,
      required: true,
    },
  },
  computed: {
    disableCostActivate() {
      if (this.used && !this.fulltech) return true;
      if (this.action.Activation === ActivationType.Protocol)
        return !this.mech.Pilot.State.IsProtocolAvailable;
      let activationCost = 0;
      if (
        this.action.Activation === ActivationType.Quick ||
        this.action.Activation === ActivationType.QuickTech
      )
        activationCost = 1;
      else if (
        this.action.Activation === ActivationType.Full ||
        this.action.Activation === ActivationType.FullTech
      )
        activationCost = 2;
      return this.mech.Pilot.State.Actions < activationCost;
    },
  },
  methods: {
    select(free: boolean) {
      this.$emit('use', free);
    },
  },
};
</script>
